\subsection{Logarithm Approximation}
We then computed $\log\left(1+x\right)$ for various encrypted inputs using both the original quadrature formula by Khattri (Equation~\ref{eq:standard_logarithm_quadrature}) and our scaled approximation (Equation~\ref{eq:optimal_log_approximation}). These were compared with the values returned by the built-in logarithm function in Python. Several data points are shown in Table~\ref{tab:log_approximation}.

We note that the privacy-preserving floating-point arithmetic resulted in some degree of floating-point error, as the observed floating point error in Table~\ref{tab:log_approximation} is greater than the raw absolute error observed in Figure~\ref{fig:log_error_comparison}. Figure~\ref{fig:comp_log} shows a plot of the observed absolute error of the original quadrature approximation and scaled quadrature approximation to the logarithm, when computed using privacy-preserving arithmetic through the Paillier cryptosystem. While there are intervals where the original quadrature approximation is more accurate than the scaled quadrature approximation, we can see that the scaled quadrature is more accurate for larger inputs.

\begin{table}[ht]
	\caption{Comparison of logarithm approximation errors under Paillier}
	\label{tab:log_approximation}
	\begin{tabular}{lcc}
		\toprule
		Input & Original quadrature & Scaled quadrature\\
		\midrule
		$\log 1$ & $0$ & $2.053729 \times 10^{-2}$\\
		$\log 10$ & $2.833179 \times 10^{-2} $ & $2.280124 \times 10^{-1}$\\
		$\log 50$ & $2.170779 \times 10^{-2}$ & $2.437148 \times 10^{-2}$\\
		$\log 100$ & $3.524916 \times 10^{-1}$ & $2.122159 \times 10^{-2}$\\
		$\log 200$ & $8.859869 \times 10^{-1}$ & $1.441611 \times 10^{-1}$\\
		$\log 256$ & $1.098463 \times 10^{0}$ & $1.993136 \times 10^{-1}$\\
	\bottomrule
\end{tabular}
\end{table}

\begin{figure}[!ht]
	\centering
	\begin{tikzpicture}
		\begin{semilogyaxis}[
			xmin=0, xmax=255,
			ymin=1e-3, ymax=1.5,
			xlabel={$x$}, ylabel={Absolute error},
			grid=major,
			legend pos=south east,
			legend cell align=left,
			tick scale binop=\times,
		]
		\addplot[very thick, ACMDarkBlue] table[x=x, y=newerr] {plots/comp_log_errs.txt};
		\addplot[thick, ACMOrange] table[x=x, y=olderr] {plots/comp_log_errs.txt};
		\legend{Scaled quadrature, Original quadrature}
		\end{semilogyaxis}
	\end{tikzpicture}%
	\caption{Comparison of logarithm approximation errors under Paillier}
	\label{fig:comp_log}
\end{figure}

\subsection{Inverse Tangent Approximation}
We also computed $\arctan x$ using for various encrypted inputs using both the first five terms of Euler's series for the inverse tangent function (Equation~\ref{eq:arctan_euler_partial}) and our quadrature approximation (Equation~\ref{eq:arctan_quadrature}). These were compared with the values returned by the built-in inverse tangent function in Python. We show several data points in Table~\ref{tab:arctan_approximation}, and show graphs of the observed error in Figure~\ref{fig:comp_arctan}. Similar to the logarithm approximations, we note that there is a degree of floating-point error compared to that predicted by Figure~\ref{fig:arctan_error}, but the quadrature approach obtains higher accuracy despite requiring a similar number of floating-point operations to execute.

\begin{table}[ht]
	\caption{Comparison of inverse tangent approximation errors under Paillier}
	\label{tab:arctan_approximation}
	\begin{tabular}{lcc}
		\toprule
		Input & Partial sum of Euler's series & Quadrature\\
		\midrule
		$\arctan -1$ & $6.564089 \times 10^{-1}$ & $4.629557 \times 10^{-1}$\\
		$\arctan -0.1$ & $4.523405 \times 10^{-3}$ & $1.451929 \times 10^{-3}$\\
		$\arctan -0.01$ & $4.665260 \times 10^{-6}$ & $1.472027 \times 10^{-6}$\\
		$\arctan 0$ & $0$ & $0$\\
		$\arctan 0.01$ & $4.665228 \times 10^{-6}$ & $1.472020 \times 10^{-6}$\\
		$\arctan 0.1$ & $4.523405 \times 10^{-3} $ & $1.451929 \times 10^{-3}$\\
		$\arctan 1$ & $6.564089 \times 10^{-1} $ & $4.629557 \times 10^{-1}$\\
	\bottomrule
\end{tabular}
\end{table}

\begin{figure}[!ht]
	\centering
	\begin{tikzpicture}
		\begin{semilogyaxis}[
			xmin=-1, xmax=1,
			ymin=1e-7, ymax=1,
			xlabel={$x$}, ylabel={Absolute error},
			grid=major,
			legend pos=south east,
			legend cell align=left,
			tick scale binop=\times,
		]
		\addplot[very thick, ACMDarkBlue] table[x=x, y=newerr] {plots/comp_arctan_errs.txt};
		\addplot[thick, ACMOrange] table[x=x, y=olderr] {plots/comp_arctan_errs.txt};
		\legend{Gauss--Legendre quadrature, Partial sum of Euler's series}
		\end{semilogyaxis}
	\end{tikzpicture}%
	\caption{Comparison of inverse tangent approximation errors under Paillier}
	\label{fig:comp_arctan}
\end{figure}

\subsection{Timing Results}

\begin{figure}[!ht]
	\centering
	\begin{tikzpicture}
		\begin{axis}[
			% xmin=0, xmax=255,
			ytick={1,2},
			yticklabels={Scaled quadrature, Original quadrature},
			xlabel={Time (seconds)},
			grid=major,
			legend pos=north east,
			legend cell align=left,
		]
		\addplot+[boxplot, thick, ACMDarkBlue] table[x=x, y=newt] {plots/comp_log_errs.txt};
		\addplot+[boxplot, thick, ACMOrange] table[x=x, y=oldt] {plots/comp_log_errs.txt};
		\end{axis}
	\end{tikzpicture}%
	\caption{Comparison of logarithm computation times under Paillier}
	\label{fig:times_log}
\end{figure}

\begin{figure}[!ht]
	\centering
	\begin{tikzpicture}
		\begin{axis}[
			% xmin=0, xmax=255,
			ytick={1,2},
			yticklabels={Gauss--Legendre quadrature, Euler's series},
			xlabel={Time (seconds)},
			grid=major,
			legend pos=north east,
			legend cell align=left,
		]
		\addplot+[boxplot, thick, ACMDarkBlue] table[x=x, y=newt] {plots/comp_arctan_errs2.txt};
		\addplot+[boxplot, thick, ACMOrange] table[x=x, y=oldt] {plots/comp_arctan_errs2.txt};
		\end{axis}
	\end{tikzpicture}%
	\caption{Frequency distribution of inverse tangent computation times under Paillier}
	\label{fig:times_arctan}
\end{figure}

% \begin{figure}[!ht]
% 	\centering
% 	\begin{tikzpicture}
% 		\begin{axis}[
% 			xmin=0, xmax=1,
% 			ymin=1.5, ymax=2.5,
% 			xlabel={Absolute error}, ylabel={Time (seconds)},
% 			grid=major,
% 			legend pos=south east,
% 			legend cell align=left,
% 			tick scale binop=\times,
% 		]
% 		\addplot+[scatter, only marks, ACMDarkBlue] table[x=newerr, y=newt] {plots/comp_arctan_errs2.txt};
% 		\addplot+[scatter, only marks, ACMOrange] table[x=olderr, y=oldt] {plots/comp_arctan_errs2.txt};
% 		\legend{Gauss--Legendre quadrature, Partial sum of Euler's series}
% 		\end{axis}
% 	\end{tikzpicture}%
% 	\caption{Accuracy vs. time in inverse tangent computation under Paillier}
% 	\label{fig:acc_vs_time_arctan}
% \end{figure}